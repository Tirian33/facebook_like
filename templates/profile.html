<html>
    <head>
        <link rel="stylesheet" href="profile.css">
        <title>{{account['fName']}} {{account['lName']}}'s Profile</title>
    </head>
    <body>
        <!-- User Account Dropdown -->
        <div class="user-account">
            <div class="user-avatar">
                {% if user.profileImageID != None %}
                        <img src="/api/images/{{user.profileImageID}}" alt="">
                        {% else %}
                        <img src="static/public/profile.png" alt="">
                        {% endif %}
            </div>
            <div class="user-dropdown">
                <button class="user-dropdown-button" id="user-dropdown-button">{{user.username}}</button>
                <div class="user-dropdown-content" id="user-dropdown-content">
                    <a href="/friends">View Friends</a>
                    <a href="/settings">Settings</a>
                    <a href="/" id="logout">Logout</a>
                </div>
            </div>
        </div>
        <div class="profilecard">
            <div class="infoimages">
                {% if account.coverImageID != None %}
                        <img src='/api/images/{{account.coverImageID}}'/>
                {% else %}
                        <img src="/static/public/cover-page.jpg">
                {% endif %}
                {% if account.profileImageID != None %}
                        <img src='/api/images/{{account.profileImageID}}'/>
                {% else %}
                        <img src="/static/public/profile.png"/> 
                {% endif %}
            </div>
            <div class="profileinfo">
                <span>{{account['fName']}} {{account['lName']}}</span>
                <span>Bio: {{account['bio']}} </span>
                <span>Friend Code: {{ account['friendCode'] }}</span>
            </div>
            <hr>
            <div class="followerinfo">
                <div class="following">
                    <span>{{friends|length}}</span>
                    <a href="/friends" style="color:black" class="btn">Friends</a>
                </div>
                <div class="vl"></div>
                <div class="post">
                    <span>{{timeline|length}}</span>
                    <a href="/profile" style="color:black" class="btn">Posts</a>
                </div>
            </div>
            <hr>
        </div>
    </body>

    &nbsp
    <body>
        <div class="profilecard">
            <form method="POST" action="/api/post" enctype="multipart/form-data" id="postForm">
                <div class="row">
                  <h2 style="text-align:center">Create a New Post</h2>
                  <div class="col">
                    <div class="hide-md-lg">
                    </div>
                    <input type="text" name="textContent" placeholder="What's on your mind?" id="username" required>
                    <input type="text" id="sharedPostId" name="sharedPostId" value="None" style="display: none;"><br>
                    <input type="text" id="postedOnID" value= {{pageOwner}} name="postedOnID" style="display: none;">
                    <input type="file" id="actual-btn" name="pic"/>
                    <input type="submit" value="Create Post", id="loginButton">
                  </div>
                </div>
              </form>
        </div>
        <div id="edit-popup" class="popup">
            <div class="popup-content">
                <span class="close" id="close-edit-popup">&times;</span>
                <h2>Send a Message to <span id="message-popup-username"></span></h2>
                <textarea id="message-text" placeholder="Type your message here..."style="width: 305px; height: 112px;"></textarea>
                <button id="send-message-button">Send</button>
            </div>
        </div>
    </body>


    {%for post in timeline %}
    &nbsp
    <body>
        <div class="postcard">
            <div class="postinfo">
                <div class="post-header">
                    <div class="post-profile">
                        {% if posterAccts[post.id].profileImageID != None %}
                        <img src='/api/images/{{posterAccts[post.id].profileImageID}}' class="mini-profile"/>
                            {% else %}
                            <img src="/static/public/profile.png" class="mini-profile"/>    
                        {% endif %}
                    </div>
                    <div class="post-header-text">
                        <div class="post-poster">
                        <span>{{postable[post.posterID]}}</span>
                        </div>
                        {% if post.createdAt %}
                        <div class="post-datetime">
                        <span> {{ post.createdAt.strftime('%b. %d, %Y at %I:%M %p') }}</span>
                        </div>
                        {% endif %}
                    </div> 
                </div>
                        
                <div class="post-content">
                    <div class="post-text">
                    <span>{{post.textContent}}</span>
                    </div>
                    {% if post.associatedImageID != None %}
                    <div>
                        <img src='/api/images/{{post.associatedImageID}}' class="imghandle"/>
                        <span></span>
                    </div>
                    {% endif %}
                </div>
                

                <div class="post-response">
                    <div>
                        {% if likedPosts.count(post.id) > 0 %}
                        <form  class="likeForm", id="{{ post.id }}" user-already-liked="True" reaction-id={{userReactions[post.id]}}>
                            <input type="text" id="reactionType" value={{1}} name="reactionType" style="display: none;">
                            <input type="text" id="respTo" value= {{post.id}} name="respTo" style="display: none;">
                            <button class="like-button" type="submit" style="background-color: rgb(207, 245, 212);transform: scale(1.2)">
                        {% else %}
                        <form  class="likeForm", id="{{post.id}}", user-already-liked="False">
                            <input type="text" id="reactionType" value={{1}} name="reactionType" style="display: none;">
                            <input type="text" id="respTo" value= {{post.id}} name="respTo" style="display: none;">
                            <button class="like-button" type="submit">
                        {% endif %}
                                <svg height="25" width="25" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                                    viewBox="0 0 49.625 49.625" xml:space="preserve">
                                     <g>
                                        <path style="fill:#0e6e1d;" d="M12.94,26.221c-3.98,0-7.96,0-11.94,0c-0.545,0-1,0.455-1,1c0,6.218,0,12.436,0,18.654
                                            c0,0.746,0,1.491,0,2.237c0,0.545,0.455,1,1,1c3.98,0,7.96,0,11.94,0c0.273,0,0.476-0.102,0.633-0.244
                                            c0.024-0.018,0.049-0.033,0.071-0.053c0.018-0.02,0.032-0.043,0.048-0.064c0.144-0.158,0.247-0.362,0.247-0.638
                                            c0-6.218,0-12.436,0-18.654c0-0.746,0-1.491,0-2.237C13.94,26.676,13.485,26.221,12.94,26.221z M2,28.221c3.313,0,6.627,0,9.94,0
                                            c0,5.885,0,11.769,0,17.654c0,0.413,0,0.825,0,1.237c-3.313,0-6.627,0-9.94,0c0-5.885,0-11.769,0-17.654
                                            C2,29.046,2,28.633,2,28.221z M48.711,34.767c0-0.342,0-0.683,0-1.025c0.928-0.664,0.907-2.425,0.911-3.459
                                            c0.004-0.943,0.045-1.912-0.572-2.679c-0.164-0.203-0.383-0.321-0.619-0.402c0-0.063,0-0.126,0-0.189
                                            c0.03-0.003,0.059-0.005,0.089-0.008c0.402-0.035,0.901-0.275,0.964-0.734c0.161-1.167,0.074-2.353,0.087-3.527
                                            c0.016-1.515-0.476-2.767-1.748-3.647c-1.318-0.912-3.153-0.71-4.684-0.735c-3.415-0.057-6.831-0.121-10.246-0.185
                                            c0.703-0.893,1.405-1.787,2.106-2.682c1.358-1.736,2.742-3.374,3.678-5.384c0.93-1.997,1.654-4.491,0.797-6.643
                                            c-0.603-1.514-1.916-2.644-3.545-2.895c-1.56-0.24-3.17,0.208-4.291,1.348c-0.485,0.494-0.763,1.097-1.089,1.694
                                            c-0.341,0.624-0.71,1.234-1.083,1.839c-2.25,3.654-4.71,7.183-7.159,10.706c-2.318,3.335-4.662,6.653-7.038,9.948
                                            c-0.006,0.008-0.005,0.018-0.01,0.026c-0.028,0.05-0.045,0.108-0.064,0.166c-0.033,0.092-0.057,0.181-0.057,0.279
                                            c0,0.012-0.007,0.021-0.007,0.033c0,6.221,0,12.442,0,18.663c0,0.946,0,1.893,0,2.839c0,0.545,0.455,1,1,1
                                            c6.102,0,12.205,0,18.307,0c2.924,0,5.848,0,8.772,0c1.756,0,3.407-0.741,4.349-2.296c0.521-0.86,0.432-2.152,0.519-3.125
                                            c0.021-0.238,0.043-0.476,0.064-0.714c0.02-0.226,0.04-0.451,0.061-0.677c0.007-0.075,0.014-0.151,0.021-0.226
                                            c0.004-0.008,0.007-0.011,0.013-0.027c0.002-0.006,0.004-0.011,0.006-0.017c1.312-0.586,1.354-2.589,1.368-3.807
                                            c0.01-0.905,0.094-1.986-0.315-2.811C49.156,35.131,48.956,34.924,48.711,34.767z M47.908,36.508c-0.006,0-0.012-0.002-0.018-0.003
                                            c0.065-0.005,0.129-0.001,0.203-0.019C48.036,36.5,47.948,36.505,47.908,36.508z M47.694,29.056c-0.001,0-0.002-0.001-0.003-0.002
                                            c0.028,0,0.056,0.001,0.083,0.003C47.737,29.055,47.712,29.055,47.694,29.056z M47.243,40.268c0.057-0.03,0.086-0.045,0.103-0.054
                                            c-0.003,0.004-0.007,0.009-0.009,0.012C47.325,40.228,47.298,40.239,47.243,40.268z M47.462,40.043
                                            c-0.026,0.054-0.035,0.078-0.038,0.091c-0.008,0.004-0.024,0.017-0.059,0.055c-0.013,0.014-0.011,0.015-0.018,0.023
                                            c-0.03,0.013-0.094,0.041-0.139,0.047c-0.352,0.048-0.589,0.398-0.698,0.698c-0.52,1.428-0.47,3.148-0.605,4.654
                                            c0,0.005,0,0.006-0.001,0.011c-0.005,0.019-0.011,0.039-0.019,0.072c-0.001,0.003-0.111,0.21-0.126,0.235
                                            c-0.145,0.239-0.378,0.428-0.588,0.606c-0.372,0.316-0.928,0.579-1.421,0.579c-0.221,0-0.443,0-0.664,0c-3.003,0-6.007,0-9.01,0
                                            c-5.648,0-11.296,0-16.944,0c0-5.888,0-11.775,0-17.663c0-0.842,0-1.685,0-2.527c3.987-5.532,7.925-11.108,11.696-16.792
                                            c1.009-1.521,2.01-3.052,2.94-4.623c0.307-0.518,0.597-1.044,0.868-1.581c0.075-0.149,0.166-0.288,0.261-0.424
                                            c-0.124,0.177,0.153-0.17,0.21-0.228c0.056-0.057,0.116-0.11,0.175-0.163c0.025-0.022,0.022-0.021,0.031-0.03
                                            c0.008-0.006,0.003-0.002,0.015-0.01c0.148-0.109,0.308-0.202,0.47-0.287c0.042-0.022,0.085-0.041,0.127-0.06
                                            c0.011-0.002,0.114-0.044,0.14-0.054c0.148-0.052,0.301-0.091,0.454-0.125c0.043-0.009,0.086-0.016,0.13-0.023
                                            c0.012,0,0.119-0.015,0.149-0.018c0.183-0.015,0.367-0.013,0.55-0.003c0.044,0.002,0.087,0.008,0.131,0.012
                                            c0.01,0.003,0.119,0.019,0.149,0.025c0.155,0.03,0.306,0.074,0.456,0.123c0.019,0.006,0.09,0.034,0.128,0.048
                                            c0.047,0.022,0.095,0.043,0.141,0.067c0.166,0.084,0.322,0.185,0.473,0.294c-0.181-0.13,0.168,0.159,0.225,0.216
                                            c0.058,0.059,0.113,0.121,0.167,0.184c0.013,0.015,0.009,0.009,0.017,0.019c0.007,0.011,0.006,0.012,0.031,0.047
                                            c0.279,0.394,0.325,0.545,0.431,0.906c0.137,0.463,0.139,0.621,0.146,1.091c0.008,0.531-0.068,1.005-0.186,1.517
                                            c-0.489,2.127-1.655,3.913-2.966,5.604c-0.789,1.017-1.583,2.03-2.378,3.042c-0.352,0.448-0.704,0.895-1.056,1.343
                                            c-0.409,0.519-1.009,1.099-0.787,1.83c0.453,1.495,2.06,1.298,3.27,1.32c1.965,0.037,3.929,0.073,5.894,0.108
                                            c1.823,0.033,3.646,0.072,5.469,0.091c1.076,0.011,2.118,0.361,2.422,1.497c0.164,0.611,0.042,1.38,0.046,2.011
                                            c0.002,0.397,0.001,0.793-0.007,1.189c-0.045,0.004-0.091,0.008-0.136,0.012c-0.543,0.047-1,0.419-1,1c0,0.653,0,1.306,0,1.959
                                            c0,0.545,0.455,1,1,1c0.052,0,0.103-0.002,0.155-0.003c0.007,0.09,0.007,0.182,0.011,0.263c0.016,0.321,0.024,0.643,0.025,0.964
                                            c0.002,0.552,0.042,1.171-0.055,1.714c-0.002,0.012-0.003,0.013-0.005,0.023c-0.661,0.049-0.935,0.595-0.852,1.11
                                            c0,0.798,0,1.595,0,2.393c0,0.491,0.376,0.891,0.848,0.969c0.002,0.009,0.006,0.017,0.007,0.025
                                            c0.067,0.581,0.052,1.198,0.045,1.784C47.601,38.837,47.697,39.555,47.462,40.043z"/>
                                    </g>
                                </svg>
                            </button>
                        </form>
                    </div>

                    <div>
                        <form  class="shareForm", id="{{post.id}}">
                            <input type="text" id="postedOnID" value= {{pageOwner}} name="postedOnID" style="display: none;">
                            <input type="text" id="postID" value= {{post.id}} name="postID" style="display: none;">
                            <button class="share-button" type="submit">
                                <svg fill="#c28619" height="25" width="25" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                                viewBox="0 0 227.216 227.216" xml:space="preserve">
                                    <g>
                                        <g>
                                            <path d="M175.897,141.476c-13.249,0-25.11,6.044-32.98,15.518l-51.194-29.066c1.592-4.48,2.467-9.297,2.467-14.317
                                                    c0-5.019-0.875-9.836-2.467-14.316l51.19-29.073c7.869,9.477,19.732,15.523,32.982,15.523c23.634,0,42.862-19.235,42.862-42.879
                                                    C218.759,19.229,199.531,0,175.897,0C152.26,0,133.03,19.229,133.03,42.865c0,5.02,0.874,9.838,2.467,14.319L84.304,86.258
                                                    c-7.869-9.472-19.729-15.514-32.975-15.514c-23.64,0-42.873,19.229-42.873,42.866c0,23.636,19.233,42.865,42.873,42.865
                                                    c13.246,0,25.105-6.042,32.974-15.513l51.194,29.067c-1.593,4.481-2.468,9.3-2.468,14.321c0,23.636,19.23,42.865,42.867,42.865
                                                    c23.634,0,42.862-19.23,42.862-42.865C218.759,160.71,199.531,141.476,175.897,141.476z M175.897,15
                                                    c15.363,0,27.862,12.5,27.862,27.865c0,15.373-12.499,27.879-27.862,27.879c-15.366,0-27.867-12.506-27.867-27.879
                                                    C148.03,27.5,160.531,15,175.897,15z M51.33,141.476c-15.369,0-27.873-12.501-27.873-27.865c0-15.366,12.504-27.866,27.873-27.866
                                                    c15.363,0,27.861,12.5,27.861,27.866C79.191,128.975,66.692,141.476,51.33,141.476z M175.897,212.216
                                                    c-15.366,0-27.867-12.501-27.867-27.865c0-15.37,12.501-27.875,27.867-27.875c15.363,0,27.862,12.505,27.862,27.875
                                                    C203.759,199.715,191.26,212.216,175.897,212.216z"/>
                                    </g>
                                </svg>
                            </button>
                        </form>
                    </div>
                    
                    {% if (post.posterID == user.id) or (pageOwner == user.id) %}
                    <div>
                        <form  class="editForm", id="{{ post.id }}">
                            <input type="text" id="postedOnID" value= {{pageOwner}} name="postedOnID" style="display: none;">
                            <input type="text" id="postID" value= {{post.id}} name="postID" style="display: none;">
                            <button class="edit-button" type="submit" data-post-id="{{post.id}}" data-popup-id="edit-popup">
                                <svg class="svg2" fill="#0056b3" stroke-width="1" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                                    width="25" height="25" viewBox="0 0 494.936 494.936"
                                    xml:space="preserve">
                                <g>
                                    <g>
                                        <path d="M389.844,182.85c-6.743,0-12.21,5.467-12.21,12.21v222.968c0,23.562-19.174,42.735-42.736,42.735H67.157
                                            c-23.562,0-42.736-19.174-42.736-42.735V150.285c0-23.562,19.174-42.735,42.736-42.735h267.741c6.743,0,12.21-5.467,12.21-12.21
                                            s-5.467-12.21-12.21-12.21H67.157C30.126,83.13,0,113.255,0,150.285v267.743c0,37.029,30.126,67.155,67.157,67.155h267.741
                                            c37.03,0,67.156-30.126,67.156-67.155V195.061C402.054,188.318,396.587,182.85,389.844,182.85z"/>
                                        <path d="M483.876,20.791c-14.72-14.72-38.669-14.714-53.377,0L221.352,229.944c-0.28,0.28-3.434,3.559-4.251,5.396l-28.963,65.069
                                            c-2.057,4.619-1.056,10.027,2.521,13.6c2.337,2.336,5.461,3.576,8.639,3.576c1.675,0,3.362-0.346,4.96-1.057l65.07-28.963
                                            c1.83-0.815,5.114-3.97,5.396-4.25L483.876,74.169c7.131-7.131,11.06-16.61,11.06-26.692
                                            C494.936,37.396,491.007,27.915,483.876,20.791z M466.61,56.897L257.457,266.05c-0.035,0.036-0.055,0.078-0.089,0.107
                                            l-33.989,15.131L238.51,247.3c0.03-0.036,0.071-0.055,0.107-0.09L447.765,38.058c5.038-5.039,13.819-5.033,18.846,0.005
                                            c2.518,2.51,3.905,5.855,3.905,9.414C470.516,51.036,469.127,54.38,466.61,56.897z"/>
                                    </g>
                                </g>
                                </svg>
                            </button>
                        </form>
                    </div>
                    <div>
                        <form  class="deleteForm", id="{{post.id}}">
                            <input type="text" id="postedOnID" value= {{pageOwner}} name="postedOnID" style="display: none;">
                            <input type="text" id="postID" value= {{post.id}} name="postID" style="display: none;">
                            <button class="delete-button" type="submit">
                                <svg class="svg" xmlns="/static/public/delete-button-svgrepo-com.svg" width="25" height="25" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        </form>
                    </div>

                    
                    {% endif %}
                    <div class="num-reactions-text">
                        <span>{{ numLikes[post.id] }} people like this</span>
                    </div>
                    
                </div>
                

            </div>

            {% if post.replies %}
                {% for reply in post.replies %}
                    {% if reply.deletedAt == None %}
                    <div class="reply">
                        <div class="reply-header">
                            <div class="reply-profile">
                                {% if replyAccts[reply.id].profileImageID != None %}
                                <img src='/api/images/{{replyAccts[reply.id].profileImageID}}' class='mini-profile'/>
                                {% else %}
                                <img src="/static/public/profile.png" class='mini-profile'/>    
                                {% endif %}
                            </div>
                            <div class="reply-header-text">
                                <div class="reply-poster">
                                    <span><SPAN STYLE="font-weight:bold">{{ postable[reply.posterID] }}</SPAN> replied:</span>
                                </div>
                                {% if post.createdAt %}
                                <div class="reply-datetime">
                                    <span> {{ reply.createdAt.strftime('%b. %d, %Y at %I:%M %p') }}</span>
                                </div>
                                {% endif %}
                            </div>
                        
                            {% if (reply.posterID == user) or (pageOwner == user)%}
                            <div>
                                <form  class="replyDeleteForm", id="{{ reply.id }}">
                                    <input type="text" id="postedOnID" value= {{pageOwner}} name="postedOnID" style="display: none;">
                                    <input type="text" id="replyID" value= {{reply.id}} name="replyID" style="display: none;">
                                    <button class="reply-delete-button" type="submit">
                                        <svg class='svg' xmlns="/static/public/delete-button-svgrepo-com.svg" width="15px" height="15px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </form>
                            </div>
                            {% endif %}
                        </div>
                            <div class="reply-content">
                                <div class="reply-text">
                                    <span>{{ reply.textContent }}</span>
                                </div>
                            </div>  
                        </div> 
                    {% endif %}
                {% endfor %}
            {% endif %}
          
            <form method="POST" action="/api/reply" enctype="multipart/form-data" class="commentForm" id = "{{ post.id }}">
                <div class="row">
                    <input type="text" name="textContent" placeholder="Reply to this post..." id="username" required>
                    <input type="text" id="respTo" value= {{post.id}} name="respTo" style="display: none;">
                    <input type="submit" value="Reply", id="loginButton">
                  </div>
                </div>
            </form>
        </div>
    </body>
    {% endfor %}
    
    <script>
        //LogoutButton
        document.addEventListener("DOMContentLoaded", function() {
            // User Account Dropdown
            const userDropdownButton = document.getElementById("user-dropdown-button");
            const userDropdownContent = document.getElementById("user-dropdown-content");

            userDropdownButton.addEventListener("click", () => {
                userDropdownContent.classList.toggle("show");
            });

            // Close the dropdown if the user clicks outside of it
            window.addEventListener("click", (event) => {
                if (event.target !== userDropdownButton) {
                    userDropdownContent.classList.remove("show");
                }
            });



            document.getElementById('logout').addEventListener('click', function(event) {
                event.preventDefault();

                fetch('/api/logout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ "content": "yes" }), 
                }).then(function (res) {
                        if (res.status == 200) {
                            window.location.href = '/login';
                        } else {
                            alert('An Error has occured.');
                        }
                    })
                    .catch(function (error) {
                        console.log("ERROR ON LOGOUT:", error);
                    });

            });
        });



        var postForm = document.getElementById("postForm");
        postForm.addEventListener("submit", function(event){
                event.preventDefault();

                var data = new FormData(postForm);

                fetch('/api/post', {method: 'POST', body: data, headers: {}}).then(res => {
                    if (res.status == 200){
                        location.reload();
                    } else {
                        console.log(res);
                        alert('Something went wrong. Please try again.');
                    }
                }).catch(err => {
                    console.error("Error occured.")
                });

            });

        var commentForms = document.querySelectorAll(".commentForm");

        commentForms.forEach((CommentForm) => {reply_to_post(CommentForm)});

        function reply_to_post(commentForm) {
        commentForm.addEventListener("submit", function(event){
            event.preventDefault();

            var data = new FormData(commentForm);

            fetch('/api/reply', {method: 'POST', body: data, headers: {}}).then(res => {
                if (res.status == 200)
            {
                //JWT should be set so lets go to the home page
                location.reload();
            } else {
                    console.log(res);
                    alert('Something went wrong. Please try again.');
                }
            }).catch(err => {
                console.error("Error occured.")
            });

        });}

        var deleteForms = document.querySelectorAll(".deleteForm");

        deleteForms.forEach((deleteForm) => {delete_post(deleteForm)});

        function delete_post(deleteForm) {
        deleteForm.addEventListener("submit", function(event){
            event.preventDefault();

            var data = new FormData(deleteForm);
            let path = '/api/post/'
            

            fetch(path.concat(deleteForm.id), {method: 'DELETE', body: data, headers: {}}).then(res => {
                if (res.status == 200)
            {
                //JWT should be set so lets go to the home page
                location.reload();
            } else {
                    console.log(res);
                    alert('You do not have permission to delete this post.');
                }
            }).catch(err => {
                console.error("Error occured.")
            });

        });}

        var likeForms = document.querySelectorAll(".likeForm");

        likeForms.forEach((likeForm) => {like_post(likeForm)});

        function like_post(likeForm) {
            likeForm.addEventListener("submit", function(event){
            event.preventDefault();

            var data = new FormData(likeForm);
            const userLiked = likeForm.getAttribute('user-already-liked');
            
            if (userLiked == "False") {

                fetch('/api/reaction', {method: 'POST', body: data, headers: {}}).then(res => {
                    if (res.status == 200)
                {
                    //JWT should be set so lets go to the home page
                    location.reload();
                } else {
                        console.log(res);
                        alert('You have already liked this post.');
                    }
                }).catch(err => {
                    console.error("Error occured.")
                });
            }

            if (userLiked == "True") {
            
                const reactionID = likeForm.getAttribute('reaction-id')
                let path = '/api/reaction/'

                fetch(path.concat(reactionID), {method: 'DELETE', body: data, headers: {}}).then(res => {
                    if (res.status == 200)
                {
                    //JWT should be set so lets go to the home page
                    location.reload();
                } else {
                        console.log(res);
                        alert('You have already liked this post.');
                    }
                }).catch(err => {
                    console.error("Error occured.")
                });
            }

        });}



        var replyDeleteForms = document.querySelectorAll(".replyDeleteForm");

        replyDeleteForms.forEach((replyDeleteForm) => {delete_reply(replyDeleteForm)});

        function delete_reply(replyDeleteForm) {
        replyDeleteForm.addEventListener("submit", function(event){
            event.preventDefault();

            var data = new FormData(replyDeleteForm);
            let path = '/api/reply/'
            

            fetch(path.concat(replyDeleteForm.id), {method: 'DELETE', body: data, headers: {}}).then(res => {
                if (res.status == 200)
            {
                //JWT should be set so lets go to the home page
                location.reload();
            } else {
                    console.log(res);
                    alert('You do not have permission to delete this reply.');
                }
            }).catch(err => {
                console.error("Error occured.")
            });

        });}


            //functions
            function getCookie(name) {
                var value = "; " + document.cookie;
                var parts = value.split("; " + name + "=");
                if (parts.length === 2) return parts.pop().split(";").shift();
            }

    </script>


    <style>
        * {box-sizing: border-box}
    
    /* style inputs and link buttons */
    input,
    .btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 4px;
      margin: 5px 0;
      opacity: 0.85;
      display: inline-block;
      font-size: 17px;
      line-height: 20px;
      text-decoration: none; /* remove underline from anchors */
    }
    label {
        background-color: rgb(100, 98, 102);
        color: white;
        padding: 0.5rem;
        font-family: sans-serif;
        border-radius: 0.3rem;
        cursor: pointer;
        margin-top: 1rem;
        }
    
    input:hover,
    .btn:hover {
      opacity: 1;
    }
    
    
    /* style the submit button */
    input[type=submit] {
      background-color: #007BFF;
      color: white;
      cursor: pointer;
    }
    
    input[type=submit]:hover {
      background-color: #0056b3;
    }
    
    /* Two-column layout */
    .col {
      float: center;
      width: 50%;
      margin: auto;
      padding: 0 50px;
      margin-top: 6px;
    }
    
    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }
    
    
    /* hide some text on medium and large screens */
    .hide-md-lg {
      display: none;
    }
    
    /* bottom container */
    .bottom-container {
      text-align: center;
      background-color: #666;
      border-radius: 0px 0px 4px 4px;
    }
    
    /* Responsive layout - when the screen is less than 650px wide, make the two columns stack on top of each other instead of next to each other */
    @media screen and (max-width: 650px) {
      .col {
        width: 100%;
        margin-top: 0;
      }
      /* hide the vertical line */
      .vl {
        display: none;
      }
      /* show the hidden text on small screens */
      .hide-md-lg {
        display: block;
        text-align: center;
      }
    }
      </style> 
<style>
    body {
    background-color: rgb(250, 252, 252);
}

.profilecard {
    margin: auto;
    background-color: rgb(232, 232, 231);
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-self: center;
    width: 70%;
    border-radius: 20px;
    overflow-x: clip;
}

.profileinfo {
    display: flex;
    font-size: 36;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-top: 7%;
    
}

.profileinfo>span:nth-of-type(2) {
    font-size: 18;

}

.profileinfo>span:nth-of-type(3) {
    font-size: 18;

}

.post-header {
 display: flex;
 align-items: left; 
 grid-template-columns: 1fr 1fr 1fr;
 column-gap: 1px;
 justify-content: left;
}

.post-response {
 display: flex;
 align-items: left;
 margin-top: 1px; 
 grid-template-columns: 1fr 1fr 1fr;
 column-gap: 1px;
 justify-content: left;
}

.post-poster {
    font-size: 18;
    margin-top: 30px;
    margin-left: 5px;
    font-weight: bold;
}

.post-datetime {
    font-size: 12;
    margin-top: 0%;
    margin-left: 5px;
}

.post-content {
    border: 1px solid grey;
    margin-top: 1%;
    margin-left: 2%;
    margin-right: 2%;
    border-radius: 20px;
}

.post-text {
    font-size: 18;
    margin-top: 30px;
    margin-left: 90px;
    margin-right: 90px;
    margin-bottom: 30px;
    font-weight: bold;
}


.popup {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 999; /* Ensure it's on top of other elements */
}

.close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    cursor: pointer;
}

.delete-button {
    position: relative;
    margin-top: 20px;
    margin-left: 20px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    border: 2px solid rgb(231, 50, 50);
    background-color: #fff;
    cursor: pointer;
    box-shadow: 0 0 10px #333;
    overflow: hidden;
    transition: .3s;
}

.delete-button:hover {
    background-color: rgb(245, 207, 207);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}

.like-button {
    position: relative;
    margin-top: 20px;
    margin-left: 40px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    border: 2px solid rgb(50, 231, 68);
    background-color: #ffffff;
    cursor: pointer;
    box-shadow: 0 0 10px #333;
    overflow: hidden;
    transition: .3s;
}

.like-button:hover {
    background-color: rgb(207, 245, 212);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}


.delete-button:hover {
    background-color: rgb(245, 207, 207);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}


.num-reactions-text{
    margin-top: 35px;
    margin-left: 40px;
    color: rgb(100, 98, 102);
    font-weight: bold;
    

}
.reply-delete-button {
    position: relative;
    margin-top: 10px;
    margin-left: 620px;
    width: 25px;
    height: 25px;
    border-radius: 25px;
    border: 2px solid rgb(231, 50, 50);
    background-color: #fff;
    cursor: pointer;
    box-shadow: 0 0 5px #333;
    overflow: hidden;
    transition: .3s;
}

.reply-delete-button:hover {
    background-color: rgb(245, 207, 207);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}

.svg {
    color: rgb(231, 50, 50);
    position: absolute;
    transform: translate(-50%, -50%);
    transition: .03s;
}

.svg2 {
    color: rgb(231, 50, 50);
    position: absolute;
    transform: translate(-50%, -50%);
    transition: .03s;
}

.edit-button {
    position: relative;
    margin-top: 20px;
    margin-left: 20px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    border: 2px solid rgb(43, 6, 226);
    background-color: #ffffff;
    cursor: pointer;
    box-shadow: 0 0 10px #333;
    overflow: hidden;
    transition: .3s;
}

.edit-button:hover {
    background-color: rgb(207, 211, 245);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}

.share-button {
    position: relative;
    margin-top: 20px;
    margin-left: 20px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    border: 2px solid #c28619;
    background-color: #ffffff;
    cursor: pointer;
    box-shadow: 0 0 10px #333;
    overflow: hidden;
    transition: .3s;
}

.share-button:hover {
    background-color: rgb(245, 239, 207);
    transform: scale(1.2);
    box-shadow: 0 0 4px #111;
    transition: .3s;
}

.commentForm {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    
}

.reply-header {
 display: flex;
 align-items: left; 
 grid-template-columns: 1fr 1fr 1fr;
 column-gap: 1px;
 justify-content: left;
}

.reply-poster {
    font-size: 18;
    margin-top: 30px;
    margin-left: 5px;
}

.reply-datetime {
    font-size: 12;
    margin-top: 0%;
    margin-left: 5px;
}

.reply-content {
    margin-left: 2%;
    margin-bottom: 2%;
    margin-right: 2%;
    border-radius: 20px;
}

.reply-text {
    font-size: 18;
    margin-top: 15px;
    margin-right: 15px;
    margin-bottom: 15px;
}

.reply {
    display: flex;
    font-size: 14;
    flex-direction: column;
    gap: 1rem;
    margin-left: 7%;
    margin-right: 7%;
    border-radius: 20px;
    background-color: rgb(253, 252, 252);
    border: 1px solid grey;
}


.postcard {
    margin: auto;
    background-color: rgb(232, 232, 231);
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-self: left;
    width: 70%;
    border-radius: 20px;
    overflow-x: clip;
}

.postinfo {
    display: flex;
    font-size: 18;
    flex-direction: column;
    justify-content: center;
    gap: 1rem;
    margin-top: 3%;
    margin-left: 3%;
    margin-right: 3%;
    border-radius: 20px;
    background-color: rgb(253, 252, 252);
}

.profileinfo>span:nth-of-type(1) {
    font-weight: bold;

}

.followerinfo {
    display: flex;
    gap: 3rem;
    justify-content: center;
    align-items: center;

}

.following {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.following>span:nth-of-type(1) {
    font-weight: bold;
    font-size: large;
}

.follower {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.follower>span:nth-of-type(1) {
    font-weight: bold;
    font-size: large;
}

.post {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.post>span:nth-of-type(1) {
    font-weight: bold;
    font-size: large;
}

.vl {
    height: 60px;
    border: 1px solid grey;
}

hr {
    border: 1px solid grey;
    width: 500px;
}

.infoimages {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
}

.infoimages>img:nth-of-type(1) {
    width: 100%;
    height: 250px;
}

.infoimages>img:nth-of-type(2) {
    width: 200px;
    height: 200px;
    border-radius: 50%;
    position: absolute;
    bottom: -5rem;
    object-fit: cover;
    border: 2px solid #555;
}

.mini-profile {
    border: 2px solid #555;
    display: flex;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    margin-top: 15px;
    margin-left: 15px;
    overflow: hidden;
    position: left;
    object-fit: cover;
   
}

.imghandle {
    border: 2px solid #a0a0a0;
    height: 400px;
    width: 80%;
    border-radius: 20px;
    margin-left: 10%;
    margin-bottom: 5%;

}

.user-account {
    background-color: #1877f2; 
    color: #fff;
    text-align: center;
    padding: 10px;
    position: fixed; 
    top: 0; 
    left: 0;
    width: 100%;
    height: 75px; 
    z-index: 1; 
    border-radius: 1px 15px 15px 15px;

}

.user-avatar {
    border: 2px solid #555;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 10px;
}

.user-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.user-dropdown {
    position: absolute;
}

.user-dropdown-button {
    border-radius: 10%;
    background: none;
    border: none;
    cursor: pointer;
    height: 5px;
    color: #fff;
    font-weight: bold;
}

.user-dropdown-content {
    display: none;
    position: absolute;
    background-color: #fff;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    right: 0;
    left:30;
    border-radius: 15px 15px 15px 15px;
}

.user-dropdown-content a {
    color: #333;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.user-dropdown-content a:hover {
    background-color: #f2f2f2;
    border-radius: 15px 15px 15px 15px;
}

.show {
    display: block;
}
</style>
</html>